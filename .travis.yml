---
branches:
  only:
    - master
language: ruby
bundler_args: --without system_tests
script: bundle exec rake test
after_success:
  - git clone -q git://github.com/puppetlabs/ghpublisher.git .forge-releng
  - .forge-releng/publish
rvm:
  - 2.1.9
env:
  global:
    - STRICT_VARIABLES=yes
    - TRUSTED_NODE_DATA=yes
  matrix:
    - PUPPET_VERSION="~> 4.7.0"
    - PUPPET_VERSION="~> 4.5.0"
    - PUPPET_VERSION="~> 3.8.0"
    - PUPPET_VERSION="~> 4.4.0"
    - PUPPET_VERSION="~> 4.3.0"
    - PUPPET_VERSION="~> 3.8.0" FUTURE_PARSER=yes
  secure: |-
      XYhK2TXSAjVeXWONjNpxKrKA6ogF5kazF/81eP5i0FzRoXUI+yemSYsrlA8oIRZjL6qrfCIT
      UYKBYeySBrJ4qM9K36mTiqOx1VuevAuM8GRTy4h52lx0MHa/puFvHwKbMbjkBVurhyyZg8mL
      cAtGs+KU2/oehrdBgyVfgQ08M9E=
matrix:
  matrix:
    fast_finish: true
    allow_failures:
      - env: PUPPET_VERSION="~> 4.5.0"
      - env: PUPPET_VERSION="~> 3.8.0"
      - env: PUPPET_VERSION="~> 4.4.0"
      - env: PUPPET_VERSION="~> 4.3.0"
      - env: PUPPET_VERSION="~> 3.8.0" FUTURE_PARSER=yes
  include:
    - rvm: default
      sudo: required
      services: docker
      env: BEAKER_set="centos-7"
      bundler_args:
      script: bundle exec rspec spec/acceptance
    - rvm: default
      sudo: required
      services: docker
      env: BEAKER_set="debian-8"
      bundler_args:
      script: bundle exec rspec spec/acceptance
notifications:
  email: false
